<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Система управления пациентами с заболеваниями щитовидной железы</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="static/styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-stethoscope"></i>
                <div>
                    <h1>Управление пациентами с заболеваниями щитовидной железы</h1>
                    <p>Только для медицинских специалистов</p>
                </div>
            </div>
            <div class="user-info">
                <i class="fas fa-user-md"></i> Панель врача
            </div>
        </header>

        <div class="server-status">
            <div id="serverStatus">Проверка состояния сервера...</div>
            <button class="btn btn-primary" onclick="testAPI()" style="padding: 5px 10px; font-size: 0.9rem;">
                <i class="fas fa-plug"></i> Проверить подключение к API
            </button>
        </div>

        <div class="main-content">
            <!-- Боковая панель со списком пациентов -->
            <div class="sidebar">
                <h2 class="section-title">
                    <i class="fas fa-users"></i> Пациенты
                </h2>
                <div class="patient-list" id="patientList">
                    <!-- Список пациентов будет заполнен JavaScript -->
                </div>
                <button class="btn btn-accent btn-block" id="addPatientBtn">
                    <i class="fas fa-user-plus"></i> Добавить нового пациента
                </button>
            </div>

            <!-- Основная область контента -->
            <div class="content">
                <div class="patient-header" id="patientHeader">
                    <div>
                        <h2 class="patient-name" id="patientName">Выберите пациента или добавьте нового</h2>
                        <div class="patient-status" id="patientStatus">Пациент не выбран</div>
                    </div>
                    <div id="patientActions" style="display: none;">
                        <button class="btn btn-primary" id="addReadmissionBtn">
                            <i class="fas fa-calendar-plus"></i> Добавить данные наблюдения (1.5 года)
                        </button>
                    </div>
                </div>

                <div class="tab-container">
                    <div class="tabs">
                        <div class="tab active" data-tab="initial">Первичный приём</div>
                        <div class="tab" data-tab="readmission">Данные наблюдения</div>
                        <div class="tab" data-tab="results">Риск рецидива</div>
                    </div>

                    <!-- Вкладка первичного приёма -->
                    <div class="tab-content active" id="initial-tab">
                        <form id="initialForm">
                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-user-circle"></i> Информация о пациенте
                                </h3>
                                <div class="form-row">
                                    <div class="form-col">
                                        <label for="patient_name" class="required-field">Имя пациента</label>
                                        <input type="text" id="patient_name" name="patient_name" placeholder="Введите имя пациента" required>
                                    </div>
                                    <div class="form-col">
                                        <label for="age_onset" class="required-field">Возраст при начале заболевания</label>
                                        <input type="number" id="age_onset" name="age_onset" min="0" max="120" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-col">
                                        <label for="sex" class="required-field">Пол</label>
                                        <select id="sex" name="sex" required>
                                            <option value="" disabled selected hidden>Выберите пол</option>
                                            <option value="1">Мужской</option>
                                            <option value="0">Женский</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-dna"></i> Наследственность и образ жизни
                                </h3>
                                <div class="form-row">
                                    <div class="form-col">
                                        <label for="heredity">Наследственная предрасположенность</label>
                                        <select id="heredity" name="heredity">
                                            <option value="" disabled selected hidden>Выберите вариант</option>
                                            <option value="1">Да</option>
                                            <option value="0">Нет</option>
                                        </select>
                                        <div class="unknown-checkbox">
                                            <label for="heredity_unknown">Неизвестно</label>
                                            <input type="checkbox" id="heredity_unknown" name="heredity_unknown">
                                        </div>
                                    </div>
                                    <div class="form-col">
                                        <label for="smoking_status">Курение</label>
                                        <select id="smoking_status" name="smoking_status">
                                            <option value="" disabled selected hidden>Выберите вариант</option>
                                            <option value="1">Да</option>
                                            <option value="0">Нет</option>
                                        </select>
                                        <div class="unknown-checkbox">
                                            <label for="smoking_status_unknown">Неизвестно</label>
                                            <input type="checkbox" id="smoking_status_unknown" name="smoking_status_unknown">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-procedures"></i> Первичное обследование
                                </h3>
                                <div class="form-row">
                                    <div class="form-col">
                                        <label for="us1_thyroid_volume">Первичный объём щитовидной железы (см³)</label>
                                        <input type="number" id="us1_thyroid_volume" name="us1_thyroid_volume" step="0.1" min="0">
                                        <div class="unknown-checkbox">
                                            <label for="us1_thyroid_volume_unknown">Неизвестно</label>
                                            <input type="checkbox" id="us1_thyroid_volume_unknown" name="us1_thyroid_volume_unknown">
                                        </div>
                                    </div>
                                    <div class="form-col">
                                        <label for="us1_nodules">Наличие узлов</label>
                                        <select id="us1_nodules" name="us1_nodules">
                                            <option value="" disabled selected hidden>Выберите вариант</option>
                                            <option value="1">Да</option>
                                            <option value="0">Нет</option>
                                        </select>
                                        <div class="unknown-checkbox">
                                            <label for="us1_nodules_unknown">Неизвестно</label>
                                            <input type="checkbox" id="us1_nodules_unknown" name="us1_nodules_unknown">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-col">
                                        <label for="us1_nodules_cm">Первичный размер узлов (см)</label>
                                        <input type="number" id="us1_nodules_cm" name="us1_nodules_cm" step="0.1" min="0">
                                        <div class="unknown-checkbox">
                                            <label for="us1_nodules_cm_unknown">Неизвестно</label>
                                            <input type="checkbox" id="us1_nodules_cm_unknown" name="us1_nodules_cm_unknown">
                                        </div>
                                    </div>
                                    <div class="form-col">
                                        <label for="exophthalmos">Экзофтальм</label>
                                        <select id="exophthalmos" name="exophthalmos">
                                            <option value="" disabled selected hidden>Выберите вариант</option>
                                            <option value="1">Да</option>
                                            <option value="0">Нет</option>
                                        </select>
                                        <div class="unknown-checkbox">
                                            <label for="exophthalmos_unknown">Неизвестно</label>
                                            <input type="checkbox" id="exophthalmos_unknown" name="exophthalmos_unknown">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-vial"></i> Первичные результаты анализов
                                </h3>
                                <div class="form-row">
                                    <div class="form-col">
                                        <label for="tsh_1">Первичный ТТГ</label>
                                        <input type="number" id="tsh_1" name="tsh_1" step="0.01" min="0">
                                        <div class="unknown-checkbox">
                                            <label for="tsh_1_unknown">Неизвестно</label>
                                            <input type="checkbox" id="tsh_1_unknown" name="tsh_1_unknown">
                                        </div>
                                    </div>
                                    <div class="form-col">
                                        <label for="ft4_1">Первичный свободный Т4</label>
                                        <input type="number" id="ft4_1" name="ft4_1" step="0.01" min="0">
                                        <div class="unknown-checkbox">
                                            <label for="ft4_1_unknown">Неизвестно</label>
                                            <input type="checkbox" id="ft4_1_unknown" name="ft4_1_unknown">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-col">
                                        <label for="ft3_1">Первичный свободный Т3</label>
                                        <input type="number" id="ft3_1" name="ft3_1" step="0.01" min="0">
                                        <div class="unknown-checkbox">
                                            <label for="ft3_1_unknown">Неизвестно</label>
                                            <input type="checkbox" id="ft3_1_unknown" name="ft3_1_unknown">
                                        </div>
                                    </div>
                                    <div class="form-col">
                                        <label for="ft3_to_ft4_ratio">Первичное соотношение свободного Т3/Т4</label>
                                        <input type="number" id="ft3_to_ft4_ratio" name="ft3_to_ft4_ratio" step="0.01" min="0">
                                        <div class="unknown-checkbox">
                                            <label for="ft3_to_ft4_ratio_unknown">Неизвестно</label>
                                            <input type="checkbox" id="ft3_to_ft4_ratio_unknown" name="ft3_to_ft4_ratio_unknown">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="action-buttons">
                                <button type="button" class="btn btn-primary" id="saveInitialBtn">
                                    <i class="fas fa-save"></i> Сохранить первичные данные
                                </button>
                                <button type="button" class="btn btn-danger" id="deletePatientBtn" style="display: none;">
                                    <i class="fas fa-trash"></i> Удалить пациента
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Вкладка наблюдения -->
                    <div class="tab-content" id="readmission-tab">
                        <form id="readmissionForm">
                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-heartbeat"></i> Клиническое состояние через 1.5 года
                                </h3>
                                <div class="form-row">
                                    <div class="form-col">
                                        <label for="thyrotoxic_cardiomyopathy">Тиреотоксическая кардиомиопатия</label>
                                        <select id="thyrotoxic_cardiomyopathy" name="thyrotoxic_cardiomyopathy">
                                            <option value="" disabled selected hidden>Выберите вариант</option>
                                            <option value="1">Да</option>
                                            <option value="0">Нет</option>
                                        </select>
                                        <div class="unknown-checkbox">
                                            <label for="thyrotoxic_cardiomyopathy_unknown">Неизвестно</label>
                                            <input type="checkbox" id="thyrotoxic_cardiomyopathy_unknown" name="thyrotoxic_cardiomyopathy_unknown">
                                        </div>
                                    </div>
                                    <div class="form-col">
                                        <label for="treatment_type">Тип лечения</label>
                                        <select id="treatment_type" name="treatment_type">
                                            <option value="" disabled selected hidden>Выберите вариант</option>
                                            <option value="0">Тироксин</option>
                                            <option value="1">Мерказолил</option>
                                            <option value="2">Комбинированное</option>
                                        </select>
                                        <div class="unknown-checkbox">
                                            <label for="treatment_type_unknown">Неизвестно</label>
                                            <input type="checkbox" id="treatment_type_unknown" name="treatment_type_unknown">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3 class="section-title">
                                    <i class="fas fa-stethoscope"></i> Обследование при наблюдении
                                </h3>
                                <div class="form-row">
                                    <div class="form-col">
                                        <label for="tsh_3">ТТГ через 1.5 года / до отмены</label>
                                        <input type="number" id="tsh_3" name="tsh_3" step="0.01" min="0">
                                        <div class="unknown-checkbox">
                                            <label for="tsh_3_unknown">Неизвестно</label>
                                            <input type="checkbox" id="tsh_3_unknown" name="tsh_3_unknown">
                                        </div>
                                    </div>
                                    <div class="form-col">
                                        <label for="us3_thyroid_volume">Объём щитовидной железы через 1.5 года (см³)</label>
                                        <input type="number" id="us3_thyroid_volume" name="us3_thyroid_volume" step="0.1" min="0">
                                        <div class="unknown-checkbox">
                                            <label for="us3_thyroid_volume_unknown">Неизвестно</label>
                                            <input type="checkbox" id="us3_thyroid_volume_unknown" name="us3_thyroid_volume_unknown">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-col">
                                        <label for="us3_nodules">Наличие узлов</label>
                                        <select id="us3_nodules" name="us3_nodules">
                                            <option value="" disabled selected hidden>Выберите вариант</option>
                                            <option value="1">Да</option>
                                            <option value="0">Нет</option>
                                        </select>
                                        <div class="unknown-checkbox">
                                            <label for="us3_nodules_unknown">Неизвестно</label>
                                            <input type="checkbox" id="us3_nodules" name="us3_nodules_unknown">
                                        </div>
                                    </div>
                                    <div class="form-col">
                                        <label for="us3_nodules_cm">Размер узлов через 1.5 года (см)</label>
                                        <input type="number" id="us3_nodules_cm" name="us3_nodules_cm" step="0.1" min="0">
                                        <div class="unknown-checkbox">
                                            <label for="us3_nodules_cm_unknown">Неизвестно</label>
                                            <input type="checkbox" id="us3_nodules_cm_unknown" name="us3_nodules_cm_unknown">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="action-buttons">
                                <button type="button" class="btn btn-primary" id="saveReadmissionBtn">
                                    <i class="fas fa-save"></i> Сохранить данные наблюдения
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Вкладка результатов -->
                    <div class="tab-content" id="results-tab">
                        <div class="results-container">
                            <h3 class="section-title">
                                <i class="fas fa-chart-line"></i> Оценка риска рецидива
                            </h3>
                            <p>Эта оценка рассчитывает риск рецидива заболевания на основе данных пациента, собранных во время первичного и последующих визитов.</p>
                            
                            <!-- Раздел выбора модели -->
                            <div class="model-selection" id="modelSelectionSection" style="display: none;">
                                <h4>Выберите модель прогнозирования</h4>
                                <p>Выберите подходящую модель на основе доступных данных пациента:</p>
                                <div class="model-options" id="modelOptions">
                                    <!-- Варианты моделей будут заполнены JavaScript -->
                                </div>
                            </div>
                            
                            <div id="calculationResults">
                                <div class="empty-state">
                                    <i class="fas fa-calculator"></i>
                                    <h3>Расчёт ещё не выполнен</h3>
                                    <p>Заполните данные пациента и нажмите "Рассчитать риск рецидива" для просмотра результатов.</p>
                                </div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn btn-accent" id="calculateRiskBtn">
                                    <i class="fas fa-calculator"></i> Рассчитать риск рецидива
                                </button>
                                <button class="btn btn-primary" id="viewRawDataBtn" style="display: none;">
                                    <i class="fas fa-code"></i> Просмотреть исходные данные
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>Система управления пациентами с заболеваниями щитовидной железы &copy; 2023 | Подключено к ML Backend API</p>
        </footer>
    </div>

    <script src="static/scripts.js"></script>
</body>
</html>
