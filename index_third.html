<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thyroid Illness Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f9fc;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #1a6dbb 0%, #0d4d8c 100%);
            color: white;
            padding: 25px 0;
            border-radius: 10px 10px 0 0;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo i {
            font-size: 2.5rem;
        }
        
        .logo h1 {
            font-size: 1.8rem;
            font-weight: 600;
        }
        
        .logo p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.15);
            padding: 10px 20px;
            border-radius: 50px;
        }
        
        .user-info i {
            font-size: 1.3rem;
        }
        
        .main-content {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
        }
        
        .sidebar {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .content {
            flex: 2;
            min-width: 300px;
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        h2 {
            color: #1a6dbb;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eaeaea;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h2 i {
            color: #1a6dbb;
        }
        
        .patient-selector {
            margin-bottom: 25px;
        }
        
        .patient-selector label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }
        
        .patient-selector select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            background-color: #f9f9f9;
            transition: all 0.3s;
        }
        
        .patient-selector select:focus {
            outline: none;
            border-color: #1a6dbb;
            box-shadow: 0 0 0 3px rgba(26, 109, 187, 0.2);
        }
        
        .form-section {
            margin-bottom: 25px;
        }
        
        .section-title {
            background-color: #f0f7ff;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-weight: 600;
            color: #1a6dbb;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
        }
        
        .section-title i {
            transition: transform 0.3s;
        }
        
        .form-group {
            margin-bottom: 18px;
            position: relative;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #555;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #1a6dbb;
            box-shadow: 0 0 0 3px rgba(26, 109, 187, 0.2);
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 5px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .radio-option input {
            width: auto;
        }
        
        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 14px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary {
            background-color: #1a6dbb;
            color: white;
            flex: 2;
        }
        
        .btn-primary:hover {
            background-color: #0d4d8c;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: #f0f7ff;
            color: #1a6dbb;
            flex: 1;
        }
        
        .btn-secondary:hover {
            background-color: #e1efff;
        }
        
        .btn-success {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }
        
        .btn-calculate {
            background-color: #2ecc71;
            color: white;
            width: 100%;
            margin-top: 20px;
        }
        
        .btn-calculate:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }
        
        .result-widget {
            background: linear-gradient(135deg, #f0f7ff 0%, #e1efff 100%);
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
            border-left: 5px solid #1a6dbb;
            display: none;
        }
        
        .result-widget h3 {
            color: #1a6dbb;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .risk-level {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 15px 0;
            padding: 10px 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .low-risk {
            background-color: #d5f4e6;
            color: #27ae60;
        }
        
        .medium-risk {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .high-risk {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .result-details {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #cce0ff;
        }
        
        .result-details p {
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
        }
        
        .result-details span {
            font-weight: 600;
        }
        
        .patient-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .patient-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .patient-item:hover {
            background-color: #f0f7ff;
        }
        
        .patient-item.active {
            background-color: #e1efff;
            border-left: 4px solid #1a6dbb;
        }
        
        .patient-id {
            font-weight: 600;
            color: #1a6dbb;
        }
        
        .patient-age {
            color: #666;
            font-size: 0.9rem;
        }
        
        .patient-risk {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .risk-low {
            background-color: #d5f4e6;
            color: #27ae60;
        }
        
        .risk-medium {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .risk-high {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .form-collapsed {
            display: none;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #777;
            font-size: 0.9rem;
        }
        
        /* Unknown checkbox styling */
        .unknown-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .unknown-checkbox input {
            width: auto;
        }
        
        .form-group.disabled input,
        .form-group.disabled select,
        .form-group.disabled .radio-option input {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }
        
        /* Appointment section styling */
        .appointment-section {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }
        
        .appointment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .appointment-title {
            font-weight: 600;
            color: #1a6dbb;
        }
        
        .appointment-date {
            color: #666;
            font-size: 0.9rem;
        }
        
        .add-appointment-btn {
            margin-top: 20px;
            width: 100%;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .radio-group {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-stethoscope"></i>
                    <div>
                        <h1>Thyroid Illness Management System</h1>
                        <p>For doctors to track and predict thyroid disease progression</p>
                    </div>
                </div>
                <div class="user-info">
                    <i class="fas fa-user-md"></i>
                    <span>Dr. Alexandra Volkov</span>
                </div>
            </div>
        </header>
        
        <div class="main-content">
            <div class="sidebar">
                <h2><i class="fas fa-users"></i> Patient List</h2>
                <div class="patient-selector">
                    <label for="patientSelect"><i class="fas fa-search"></i> Select Patient</label>
                    <select id="patientSelect">
                        <option value="new">+ Add New Patient</option>
                        <option value="patient1">#001 - Maria Ivanova (Age: 42)</option>
                        <option value="patient2">#002 - Dmitry Sokolov (Age: 56)</option>
                        <option value="patient3">#003 - Elena Petrova (Age: 38)</option>
                        <option value="patient4">#004 - Sergei Kuznetsov (Age: 61)</option>
                        <option value="patient5">#005 - Olga Smirnova (Age: 47)</option>
                    </select>
                </div>
                
                <div class="patient-list">
                    <div class="patient-item active" data-id="patient1">
                        <div>
                            <div class="patient-id">#001 - Maria Ivanova</div>
                            <div class="patient-age">Age: 42 | Diagnosis: Graves' disease</div>
                        </div>
                        <div class="patient-risk risk-medium">Medium Risk</div>
                    </div>
                    <div class="patient-item" data-id="patient2">
                        <div>
                            <div class="patient-id">#002 - Dmitry Sokolov</div>
                            <div class="patient-age">Age: 56 | Diagnosis: Toxic nodular goiter</div>
                        </div>
                        <div class="patient-risk risk-high">High Risk</div>
                    </div>
                    <div class="patient-item" data-id="patient3">
                        <div>
                            <div class="patient-id">#003 - Elena Petrova</div>
                            <div class="patient-age">Age: 38 | Diagnosis: Hashimoto's thyroiditis</div>
                        </div>
                        <div class="patient-risk risk-low">Low Risk</div>
                    </div>
                    <div class="patient-item" data-id="patient4">
                        <div>
                            <div class="patient-id">#004 - Sergei Kuznetsov</div>
                            <div class="patient-age">Age: 61 | Diagnosis: Graves' disease</div>
                        </div>
                        <div class="patient-risk risk-high">High Risk</div>
                    </div>
                    <div class="patient-item" data-id="patient5">
                        <div>
                            <div class="patient-id">#005 - Olga Smirnova</div>
                            <div class="patient-age">Age: 47 | Diagnosis: Subacute thyroiditis</div>
                        </div>
                        <div class="patient-risk risk-medium">Medium Risk</div>
                    </div>
                </div>
                
                <button class="btn btn-calculate" id="calculateBtn">
                    <i class="fas fa-calculator"></i> Calculate Illness Risk
                </button>
                
                <div class="result-widget" id="resultWidget">
                    <h3><i class="fas fa-chart-line"></i> Risk Assessment Result</h3>
                    <div class="risk-level" id="riskLevel">Medium Risk</div>
                    <p id="riskDescription">Based on the patient data, there is a moderate risk of thyroid disease recurrence.</p>
                    
                    <div class="result-details">
                        <p>Recurrence Probability: <span id="recurrenceProbability">42%</span></p>
                        <p>Key Risk Factors: <span id="keyFactors">Smoking history, Elevated TSH</span></p>
                        <p>Recommendation: <span id="recommendation">Continue monitoring every 6 months</span></p>
                    </div>
                </div>
            </div>
            
            <div class="content">
                <h2><i class="fas fa-edit"></i> Patient Data Form</h2>
                
                <div id="appointmentsContainer">
                    <!-- Appointment sections will be dynamically added here -->
                </div>
                
                <button class="btn btn-success add-appointment-btn" id="addAppointmentBtn">
                    <i class="fas fa-plus"></i> Add New Appointment
                </button>
                
                <form id="patientForm">
                    <div class="form-section">
                        <div class="section-title" data-section="demographics">
                            <span><i class="fas fa-user"></i> Demographics & History</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="form-section-content" id="demographicsSection">
                            <div class="form-group" data-field="age_onset">
                                <label for="age_onset">Age at disease onset (years)</label>
                                <input type="number" id="age_onset" name="age_onset" min="0" max="120" value="35">
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="age_onset_unknown" class="unknown-input">
                                    <label for="age_onset_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="heredity">
                                <label>Family history</label>
                                <div class="radio-group">
                                    <div class="radio-option">
                                        <input type="radio" id="heredity_no" name="heredity" value="0" checked>
                                        <label for="heredity_no">No</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="heredity_yes" name="heredity" value="1">
                                        <label for="heredity_yes">Yes</label>
                                    </div>
                                </div>
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="heredity_unknown" class="unknown-input">
                                    <label for="heredity_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="smoking_status">
                                <label>Smoking status</label>
                                <div class="radio-group">
                                    <div class="radio-option">
                                        <input type="radio" id="smoking_no" name="smoking_status" value="0" checked>
                                        <label for="smoking_no">No</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="smoking_yes" name="smoking_status" value="2">
                                        <label for="smoking_yes">Yes</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="smoking_history" name="smoking_status" value="3">
                                        <label for="smoking_history">History</label>
                                    </div>
                                </div>
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="smoking_status_unknown" class="unknown-input">
                                    <label for="smoking_status_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="sex">
                                <label>Sex</label>
                                <div class="radio-group">
                                    <div class="radio-option">
                                        <input type="radio" id="sex_female" name="sex" value="0" checked>
                                        <label for="sex_female">Female</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="sex_male" name="sex" value="1">
                                        <label for="sex_male">Male</label>
                                    </div>
                                </div>
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="sex_unknown" class="unknown-input">
                                    <label for="sex_unknown">Unknown</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <div class="section-title" data-section="initialExamination">
                            <span><i class="fas fa-file-medical"></i> Initial Examination</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="form-section-content" id="initialExaminationSection">
                            <div class="form-group" data-field="us1_thyroid_volume">
                                <label for="us1_thyroid_volume">Initial thyroid volume (cm³)</label>
                                <input type="number" id="us1_thyroid_volume" name="us1_thyroid_volume" step="0.1" min="0" value="25.5">
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="us1_thyroid_volume_unknown" class="unknown-input">
                                    <label for="us1_thyroid_volume_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="us1_nodules">
                                <label>Presence of nodules (initial)</label>
                                <div class="radio-group">
                                    <div class="radio-option">
                                        <input type="radio" id="us1_nodules_no" name="us1_nodules" value="0" checked>
                                        <label for="us1_nodules_no">No</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="us1_nodules_yes" name="us1_nodules" value="1">
                                        <label for="us1_nodules_yes">Yes</label>
                                    </div>
                                </div>
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="us1_nodules_unknown" class="unknown-input">
                                    <label for="us1_nodules_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="us1_nodules_cm">
                                <label for="us1_nodules_cm">Size of nodules in cm (initial)</label>
                                <input type="number" id="us1_nodules_cm" name="us1_nodules_cm" step="0.1" min="0" value="0">
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="us1_nodules_cm_unknown" class="unknown-input">
                                    <label for="us1_nodules_cm_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="tsh_1">
                                <label for="tsh_1">Initial TSH (mIU/L)</label>
                                <input type="number" id="tsh_1" name="tsh_1" step="0.01" min="0" value="0.05">
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="tsh_1_unknown" class="unknown-input">
                                    <label for="tsh_1_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="ft4_1">
                                <label for="ft4_1">Initial free T4 (pmol/L)</label>
                                <input type="number" id="ft4_1" name="ft4_1" step="0.1" min="0" value="32.5">
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="ft4_1_unknown" class="unknown-input">
                                    <label for="ft4_1_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="ft3_1">
                                <label for="ft3_1">Initial free T3 (pmol/L)</label>
                                <input type="number" id="ft3_1" name="ft3_1" step="0.1" min="0" value="12.8">
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="ft3_1_unknown" class="unknown-input">
                                    <label for="ft3_1_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="ft3_to_ft4_ratio">
                                <label for="ft3_to_ft4_ratio">Free T3/Free T4 ratio (initial)</label>
                                <input type="number" id="ft3_to_ft4_ratio" name="ft3_to_ft4_ratio" step="0.01" min="0" value="0.39">
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="ft3_to_ft4_ratio_unknown" class="unknown-input">
                                    <label for="ft3_to_ft4_ratio_unknown">Unknown</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <div class="section-title" data-section="clinicalFeatures">
                            <span><i class="fas fa-heartbeat"></i> Clinical Features</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="form-section-content" id="clinicalFeaturesSection">
                            <div class="form-group" data-field="exophthalmos">
                                <label>Exophthalmos</label>
                                <div class="radio-group">
                                    <div class="radio-option">
                                        <input type="radio" id="exophthalmos_no" name="exophthalmos" value="0" checked>
                                        <label for="exophthalmos_no">No</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="exophthalmos_yes" name="exophthalmos" value="1">
                                        <label for="exophthalmos_yes">Yes</label>
                                    </div>
                                </div>
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="exophthalmos_unknown" class="unknown-input">
                                    <label for="exophthalmos_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="thyrotoxic_cardiomyopathy">
                                <label>Thyrotoxic cardiomyopathy</label>
                                <div class="radio-group">
                                    <div class="radio-option">
                                        <input type="radio" id="thyrotoxic_cardiomyopathy_no" name="thyrotoxic_cardiomyopathy" value="0" checked>
                                        <label for="thyrotoxic_cardiomyopathy_no">No</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="thyrotoxic_cardiomyopathy_yes" name="thyrotoxic_cardiomyopathy" value="1">
                                        <label for="thyrotoxic_cardiomyopathy_yes">Yes</label>
                                    </div>
                                </div>
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="thyrotoxic_cardiomyopathy_unknown" class="unknown-input">
                                    <label for="thyrotoxic_cardiomyopathy_unknown">Unknown</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <div class="section-title" data-section="treatmentFollowup">
                            <span><i class="fas fa-pills"></i> Treatment & Follow-up</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="form-section-content" id="treatmentFollowupSection">
                            <div class="form-group" data-field="treatment_type">
                                <label>Medication type</label>
                                <div class="radio-group">
                                    <div class="radio-option">
                                        <input type="radio" id="treatment_thyroxine" name="treatment_type" value="0">
                                        <label for="treatment_thyroxine">Thyroxine</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="treatment_mercasolil" name="treatment_type" value="1" checked>
                                        <label for="treatment_mercasolil">Mercasolil</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="treatment_combination" name="treatment_type" value="2">
                                        <label for="treatment_combination">Combination</label>
                                    </div>
                                </div>
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="treatment_type_unknown" class="unknown-input">
                                    <label for="treatment_type_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="tsh_3">
                                <label for="tsh_3">TSH after 1.5 years / before discontinuation (mIU/L)</label>
                                <input type="number" id="tsh_3" name="tsh_3" step="0.01" min="0" value="1.8">
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="tsh_3_unknown" class="unknown-input">
                                    <label for="tsh_3_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="us3_thyroid_volume">
                                <label for="us3_thyroid_volume">Thyroid volume after 1.5 years / before discontinuation (cm³)</label>
                                <input type="number" id="us3_thyroid_volume" name="us3_thyroid_volume" step="0.1" min="0" value="18.2">
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="us3_thyroid_volume_unknown" class="unknown-input">
                                    <label for="us3_thyroid_volume_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="us3_nodules">
                                <label>Presence of nodules (after 1.5 years / before discontinuation)</label>
                                <div class="radio-group">
                                    <div class="radio-option">
                                        <input type="radio" id="us3_nodules_no" name="us3_nodules" value="0" checked>
                                        <label for="us3_nodules_no">No</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="us3_nodules_yes" name="us3_nodules" value="1">
                                        <label for="us3_nodules_yes">Yes</label>
                                    </div>
                                </div>
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="us3_nodules_unknown" class="unknown-input">
                                    <label for="us3_nodules_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="us3_nodules_cm">
                                <label for="us3_nodules_cm">Size of nodules in cm (after 1.5 years / before discontinuation)</label>
                                <input type="number" id="us3_nodules_cm" name="us3_nodules_cm" step="0.1" min="0" value="0">
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="us3_nodules_cm_unknown" class="unknown-input">
                                    <label for="us3_nodules_cm_unknown">Unknown</label>
                                </div>
                            </div>
                            
                            <div class="form-group" data-field="recurrence">
                                <label>Recurrence</label>
                                <div class="radio-group">
                                    <div class="radio-option">
                                        <input type="radio" id="recurrence_no" name="recurrence" value="0" checked>
                                        <label for="recurrence_no">No</label>
                                    </div>
                                    <div class="radio-option">
                                        <input type="radio" id="recurrence_yes" name="recurrence" value="1">
                                        <label for="recurrence_yes">Yes</label>
                                    </div>
                                </div>
                                <div class="unknown-checkbox">
                                    <input type="checkbox" id="recurrence_unknown" class="unknown-input">
                                    <label for="recurrence_unknown">Unknown</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Save Patient Data
                        </button>
                        <button type="button" class="btn btn-secondary" id="clearFormBtn">
                            <i class="fas fa-redo"></i> Clear Form
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="footer">
            <p>Thyroid Illness Management System v1.0 | For medical use only | Data is encrypted and HIPAA compliant</p>
            <p>© 2023 Endocrinology Clinic. All rights reserved.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Form section collapse/expand functionality
            const sectionTitles = document.querySelectorAll('.section-title');
            sectionTitles.forEach(title => {
                title.addEventListener('click', function() {
                    const sectionId = this.getAttribute('data-section');
                    const sectionContent = document.getElementById(sectionId + 'Section');
                    const icon = this.querySelector('i.fa-chevron-down');
                    
                    if (sectionContent.classList.contains('form-collapsed')) {
                        sectionContent.classList.remove('form-collapsed');
                        icon.style.transform = 'rotate(0deg)';
                    } else {
                        sectionContent.classList.add('form-collapsed');
                        icon.style.transform = 'rotate(-90deg)';
                    }
                });
            });
            
            // Patient selection functionality
            const patientSelect = document.getElementById('patientSelect');
            const patientItems = document.querySelectorAll('.patient-item');
            
            patientSelect.addEventListener('change', function() {
                const selectedPatientId = this.value;
                
                if (selectedPatientId === 'new') {
                    clearForm();
                    setFormTitle('New Patient');
                    // Remove active class from all patient items
                    patientItems.forEach(item => {
                        item.classList.remove('active');
                    });
                    // Clear appointments
                    clearAppointments();
                } else {
                    loadPatientData(selectedPatientId);
                    // Set active patient in the list
                    patientItems.forEach(item => {
                        if (item.getAttribute('data-id') === selectedPatientId) {
                            item.classList.add('active');
                        } else {
                            item.classList.remove('active');
                        }
                    });
                    // Load appointments for this patient
                    loadAppointments(selectedPatientId);
                }
            });
            
            // Patient item click functionality
            patientItems.forEach(item => {
                item.addEventListener('click', function() {
                    const patientId = this.getAttribute('data-id');
                    
                    // Update the select dropdown
                    patientSelect.value = patientId;
                    
                    // Update active state
                    patientItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Load patient data
                    loadPatientData(patientId);
                    // Load appointments for this patient
                    loadAppointments(patientId);
                });
            });
            
            // Clear form button
            document.getElementById('clearFormBtn').addEventListener('click', function() {
                clearForm();
                patientSelect.value = 'new';
                patientItems.forEach(item => item.classList.remove('active'));
                setFormTitle('New Patient');
                clearAppointments();
            });
            
            // Form submission
            document.getElementById('patientForm').addEventListener('submit', function(e) {
                e.preventDefault();
                savePatientData();
            });
            
            // Calculate risk button
            document.getElementById('calculateBtn').addEventListener('click', function() {
                calculateRisk();
            });
            
            // Add new appointment button
            document.getElementById('addAppointmentBtn').addEventListener('click', function() {
                addNewAppointment();
            });
            
            // Unknown checkbox functionality
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('unknown-input')) {
                    const checkbox = e.target;
                    const fieldId = checkbox.id.replace('_unknown', '');
                    const formGroup = checkbox.closest('.form-group');
                    
                    if (checkbox.checked) {
                        formGroup.classList.add('disabled');
                        // Clear the field value
                        const input = formGroup.querySelector('input:not(.unknown-input), select');
                        if (input) {
                            input.disabled = true;
                            // For radio buttons, uncheck all
                            if (input.type === 'radio') {
                                formGroup.querySelectorAll('input[type="radio"]').forEach(radio => {
                                    radio.checked = false;
                                });
                            } else {
                                input.value = '';
                            }
                        }
                    } else {
                        formGroup.classList.remove('disabled');
                        // Enable the field
                        const input = formGroup.querySelector('input:not(.unknown-input), select');
                        if (input) {
                            input.disabled = false;
                        }
                    }
                }
            });
            
            // Function to set form title
            function setFormTitle(title) {
                document.querySelector('.content h2').innerHTML = `<i class="fas fa-edit"></i> ${title}`;
            }
            
            // Function to load patient data (mock implementation)
            function loadPatientData(patientId) {
                // In a real application, this would fetch data from a server
                // For this demo, we'll just simulate with different data based on patientId
                
                let patientData = {};
                
                switch(patientId) {
                    case 'patient1':
                        patientData = {
                            age_onset: 35,
                            heredity: '0',
                            smoking_status: '2',
                            sex: '0',
                            us1_thyroid_volume: 25.5,
                            us1_nodules: '0',
                            us1_nodules_cm: 0,
                            tsh_1: 0.05,
                            ft4_1: 32.5,
                            ft3_1: 12.8,
                            ft3_to_ft4_ratio: 0.39,
                            exophthalmos: '1',
                            thyrotoxic_cardiomyopathy: '0',
                            treatment_type: '1',
                            tsh_3: 1.8,
                            us3_thyroid_volume: 18.2,
                            us3_nodules: '0',
                            us3_nodules_cm: 0,
                            recurrence: '0'
                        };
                        setFormTitle('Patient #001 - Maria Ivanova');
                        break;
                        
                    case 'patient2':
                        patientData = {
                            age_onset: 56,
                            heredity: '1',
                            smoking_status: '3',
                            sex: '1',
                            us1_thyroid_volume: 42.3,
                            us1_nodules: '1',
                            us1_nodules_cm: 2.5,
                            tsh_1: 0.02,
                            ft4_1: 45.2,
                            ft3_1: 18.7,
                            ft3_to_ft4_ratio: 0.41,
                            exophthalmos: '0',
                            thyrotoxic_cardiomyopathy: '1',
                            treatment_type: '2',
                            tsh_3: 0.8,
                            us3_thyroid_volume: 35.1,
                            us3_nodules: '1',
                            us3_nodules_cm: 1.8,
                            recurrence: '1'
                        };
                        setFormTitle('Patient #002 - Dmitry Sokolov');
                        break;
                        
                    case 'patient3':
                        patientData = {
                            age_onset: 38,
                            heredity: '1',
                            smoking_status: '0',
                            sex: '0',
                            us1_thyroid_volume: 18.7,
                            us1_nodules: '0',
                            us1_nodules_cm: 0,
                            tsh_1: 8.5,
                            ft4_1: 12.3,
                            ft3_1: 4.2,
                            ft3_to_ft4_ratio: 0.34,
                            exophthalmos: '0',
                            thyrotoxic_cardiomyopathy: '0',
                            treatment_type: '0',
                            tsh_3: 3.2,
                            us3_thyroid_volume: 16.5,
                            us3_nodules: '0',
                            us3_nodules_cm: 0,
                            recurrence: '0'
                        };
                        setFormTitle('Patient #003 - Elena Petrova');
                        break;
                        
                    default:
                        // Default data
                        patientData = {
                            age_onset: 35,
                            heredity: '0',
                            smoking_status: '0',
                            sex: '0',
                            us1_thyroid_volume: 25.5,
                            us1_nodules: '0',
                            us1_nodules_cm: 0,
                            tsh_1: 0.05,
                            ft4_1: 32.5,
                            ft3_1: 12.8,
                            ft3_to_ft4_ratio: 0.39,
                            exophthalmos: '0',
                            thyrotoxic_cardiomyopathy: '0',
                            treatment_type: '1',
                            tsh_3: 1.8,
                            us3_thyroid_volume: 18.2,
                            us3_nodules: '0',
                            us3_nodules_cm: 0,
                            recurrence: '0'
                        };
                        setFormTitle('Patient Data Form');
                }
                
                // Populate form fields
                for (const [key, value] of Object.entries(patientData)) {
                    const input = document.querySelector(`[name="${key}"]`);
                    if (input) {
                        if (input.type === 'radio') {
                            // For radio buttons, find the one with the correct value
                            const radioToCheck = document.querySelector(`[name="${key}"][value="${value}"]`);
                            if (radioToCheck) {
                                radioToCheck.checked = true;
                                // Reset unknown checkbox
                                const unknownCheckbox = document.getElementById(`${key}_unknown`);
                                if (unknownCheckbox) {
                                    unknownCheckbox.checked = false;
                                    const formGroup = unknownCheckbox.closest('.form-group');
                                    formGroup.classList.remove('disabled');
                                    input.disabled = false;
                                }
                            }
                        } else {
                            input.value = value;
                            input.disabled = false;
                            // Reset unknown checkbox
                            const unknownCheckbox = document.getElementById(`${key}_unknown`);
                            if (unknownCheckbox) {
                                unknownCheckbox.checked = false;
                                const formGroup = unknownCheckbox.closest('.form-group');
                                formGroup.classList.remove('disabled');
                            }
                        }
                    }
                }
                
                // Show a notification
                showNotification(`Loaded data for ${patientId === 'patient1' ? 'Maria Ivanova' : patientId === 'patient2' ? 'Dmitry Sokolov' : patientId === 'patient3' ? 'Elena Petrova' : 'patient'}`);
            }
            
            // Function to save patient data (mock implementation)
            function savePatientData() {
                // In a real application, this would send data to a server
                const formData = new FormData(document.getElementById('patientForm'));
                const data = Object.fromEntries(formData);
                
                console.log('Saving patient data:', data);
                
                // Show success message
                showNotification('Patient data saved successfully!', 'success');
                
                // If this is a new patient, add to the list
                if (patientSelect.value === 'new') {
                    // In a real app, you would get the new patient ID from the server
                    const newPatientId = 'patient' + (document.querySelectorAll('.patient-item').length + 1);
                    
                    // Update the select dropdown
                    const newOption = document.createElement('option');
                    newOption.value = newPatientId;
                    newOption.textContent = `#00${document.querySelectorAll('.patient-item').length + 1} - New Patient`;
                    patientSelect.appendChild(newOption);
                    patientSelect.value = newPatientId;
                    
                    // Add to patient list
                    const patientList = document.querySelector('.patient-list');
                    const newPatientItem = document.createElement('div');
                    newPatientItem.className = 'patient-item';
                    newPatientItem.setAttribute('data-id', newPatientId);
                    newPatientItem.innerHTML = `
                        <div>
                            <div class="patient-id">#00${document.querySelectorAll('.patient-item').length + 1} - New Patient</div>
                            <div class="patient-age">Age: ${data.age_onset} | Diagnosis: New case</div>
                        </div>
                        <div class="patient-risk risk-low">New</div>
                    `;
                    patientList.appendChild(newPatientItem);
                    
                    // Add click event to new patient item
                    newPatientItem.addEventListener('click', function() {
                        const patientId = this.getAttribute('data-id');
                        patientSelect.value = patientId;
                        patientItems.forEach(i => i.classList.remove('active'));
                        document.querySelectorAll('.patient-item').forEach(i => i.classList.remove('active'));
                        this.classList.add('active');
                        loadPatientData(patientId);
                    });
                    
                    // Set form title
                    setFormTitle(`Patient #00${document.querySelectorAll('.patient-item').length} - New Patient`);
                }
            }
            
            // Function to calculate risk (mock implementation)
            function calculateRisk() {
                // In a real application, this would send data to a prediction model/API
                const formData = new FormData(document.getElementById('patientForm'));
                const data = Object.fromEntries(formData);
                
                console.log('Calculating risk based on:', data);
                
                // Mock risk calculation based on form values
                let riskScore = 0;
                
                // Age at onset (higher age = higher risk)
                if (data.age_onset > 50) riskScore += 25;
                else if (data.age_onset > 40) riskScore += 15;
                else riskScore += 5;
                
                // Family history
                if (data.heredity === '1') riskScore += 20;
                
                // Smoking
                if (data.smoking_status === '2') riskScore += 25; // Current smoker
                else if (data.smoking_status === '3') riskScore += 15; // History
                
                // Male sex (higher risk for some thyroid conditions)
                if (data.sex === '1') riskScore += 10;
                
                // Large initial thyroid volume
                if (parseFloat(data.us1_thyroid_volume) > 30) riskScore += 15;
                
                // Initial nodules
                if (data.us1_nodules === '1') riskScore += 10;
                
                // Very low initial TSH
                if (parseFloat(data.tsh_1) < 0.1) riskScore += 10;
                
                // High initial FT4
                if (parseFloat(data.ft4_1) > 30) riskScore += 10;
                
                // Exophthalmos
                if (data.exophthalmos === '1') riskScore += 15;
                
                // Cardiomyopathy
                if (data.thyrotoxic_cardiomyopathy === '1') riskScore += 20;
                
                // TSH after treatment not normalized
                if (parseFloat(data.tsh_3) < 0.5 || parseFloat(data.tsh_3) > 4.5) riskScore += 15;
                
                // Nodules after treatment
                if (data.us3_nodules === '1') riskScore += 10;
                
                // Calculate risk percentage (normalize to 0-100)
                riskScore = Math.min(100, riskScore);
                
                // Determine risk level
                let riskLevel, riskClass, riskDescription, recommendation;
                
                if (riskScore < 30) {
                    riskLevel = "Low Risk";
                    riskClass = "low-risk";
                    riskDescription = "Based on the patient data, there is a low risk of thyroid disease recurrence.";
                    recommendation = "Continue standard follow-up annually";
                } else if (riskScore < 60) {
                    riskLevel = "Medium Risk";
                    riskClass = "medium-risk";
                    riskDescription = "Based on the patient data, there is a moderate risk of thyroid disease recurrence.";
                    recommendation = "Continue monitoring every 6 months";
                } else {
                    riskLevel = "High Risk";
                    riskClass = "high-risk";
                    riskDescription = "Based on the patient data, there is a high risk of thyroid disease recurrence.";
                    recommendation = "Consider additional treatment options and monitor every 3 months";
                }
                
                // Update result widget
                document.getElementById('riskLevel').textContent = riskLevel;
                document.getElementById('riskLevel').className = `risk-level ${riskClass}`;
                document.getElementById('riskDescription').textContent = riskDescription;
                document.getElementById('recurrenceProbability').textContent = `${riskScore}%`;
                
                // Determine key factors
                let keyFactors = [];
                if (data.heredity === '1') keyFactors.push("Family history");
                if (data.smoking_status === '2' || data.smoking_status === '3') keyFactors.push("Smoking history");
                if (parseFloat(data.tsh_1) < 0.1) keyFactors.push("Very low initial TSH");
                if (data.exophthalmos === '1') keyFactors.push("Exophthalmos");
                if (data.thyrotoxic_cardiomyopathy === '1') keyFactors.push("Cardiomyopathy");
                if (keyFactors.length === 0) keyFactors = ["None identified"];
                
                document.getElementById('keyFactors').textContent = keyFactors.join(", ");
                document.getElementById('recommendation').textContent = recommendation;
                
                // Show the result widget
                document.getElementById('resultWidget').style.display = 'block';
                
                // Show notification
                showNotification('Risk assessment completed!', 'success');
                
                // Scroll to result widget
                document.getElementById('resultWidget').scrollIntoView({ behavior: 'smooth' });
            }
            
            // Function to clear the form
            function clearForm() {
                document.getElementById('patientForm').reset();
                // Reset all unknown checkboxes
                document.querySelectorAll('.unknown-input').forEach(checkbox => {
                    checkbox.checked = false;
                    const formGroup = checkbox.closest('.form-group');
                    formGroup.classList.remove('disabled');
                    const input = formGroup.querySelector('input:not(.unknown-input), select');
                    if (input) input.disabled = false;
                });
                showNotification('Form cleared. Ready for new patient data.', 'info');
            }
            
            // Function to add new appointment
            function addNewAppointment() {
                const appointmentsContainer = document.getElementById('appointmentsContainer');
                const appointmentCount = appointmentsContainer.children.length + 1;
                const today = new Date().toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                
                const appointmentHTML = `
                    <div class="appointment-section" data-appointment="${appointmentCount}">
                        <div class="appointment-header">
                            <div class="appointment-title">Appointment #${appointmentCount}</div>
                            <div class="appointment-date">${today}</div>
                        </div>
                        <div class="form-group">
                            <label for="appointment_notes_${appointmentCount}">Notes</label>
                            <textarea id="appointment_notes_${appointmentCount}" class="appointment-notes" rows="3" placeholder="Enter appointment notes..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="appointment_tsh_${appointmentCount}">TSH (mIU/L)</label>
                            <input type="number" id="appointment_tsh_${appointmentCount}" class="appointment-tsh" step="0.01" min="0" placeholder="Enter TSH value">
                        </div>
                        <div class="form-group">
                            <label for="appointment_ft4_${appointmentCount}">Free T4 (pmol/L)</label>
                            <input type="number" id="appointment_ft4_${appointmentCount}" class="appointment-ft4" step="0.1" min="0" placeholder="Enter free T4 value">
                        </div>
                        <div class="form-group">
                            <label for="appointment_volume_${appointmentCount}">Thyroid Volume (cm³)</label>
                            <input type="number" id="appointment_volume_${appointmentCount}" class="appointment-volume" step="0.1" min="0" placeholder="Enter thyroid volume">
                        </div>
                    </div>
                `;
                
                appointmentsContainer.insertAdjacentHTML('beforeend', appointmentHTML);
                showNotification('New appointment added successfully!', 'success');
                
                // Scroll to the new appointment
                appointmentsContainer.lastElementChild.scrollIntoView({ behavior: 'smooth' });
            }
            
            // Function to load appointments for a patient
            function loadAppointments(patientId) {
                const appointmentsContainer = document.getElementById('appointmentsContainer');
                appointmentsContainer.innerHTML = '';
                
                // Mock data - in a real app, this would come from a server
                const mockAppointments = {
                    'patient1': [
                        {
                            date: '2023-10-15',
                            notes: 'Patient reports feeling better. Energy levels improved.',
                            tsh: 1.2,
                            ft4: 18.5,
                            volume: 20.3
                        },
                        {
                            date: '2023-07-20',
                            notes: 'Initial follow-up after treatment adjustment.',
                            tsh: 0.8,
                            ft4: 22.1,
                            volume: 21.5
                        }
                    ],
                    'patient2': [
                        {
                            date: '2023-09-10',
                            notes: 'Cardiomyopathy symptoms improved. Continue current treatment.',
                            tsh: 0.5,
                            ft4: 25.3,
                            volume: 33.8
                        }
                    ]
                };
                
                const appointments = mockAppointments[patientId] || [];
                
                appointments.forEach((appointment, index) => {
                    const appointmentCount = index + 1;
                    const date = new Date(appointment.date).toLocaleDateString('en-US', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    });
                    
                    const appointmentHTML = `
                        <div class="appointment-section" data-appointment="${appointmentCount}">
                            <div class="appointment-header">
                                <div class="appointment-title">Appointment #${appointmentCount}</div>
                                <div class="appointment-date">${date}</div>
                            </div>
                            <div class="form-group">
                                <label for="appointment_notes_${appointmentCount}">Notes</label>
                                <textarea id="appointment_notes_${appointmentCount}" class="appointment-notes" rows="3">${appointment.notes}</textarea>
                            </div>
                            <div class="form-group">
                                <label for="appointment_tsh_${appointmentCount}">TSH (mIU/L)</label>
                                <input type="number" id="appointment_tsh_${appointmentCount}" class="appointment-tsh" step="0.01" min="0" value="${appointment.tsh}">
                            </div>
                            <div class="form-group">
                                <label for="appointment_ft4_${appointmentCount}">Free T4 (pmol/L)</label>
                                <input type="number" id="appointment_ft4_${appointmentCount}" class="appointment-ft4" step="0.1" min="0" value="${appointment.ft4}">
                            </div>
                            <div class="form-group">
                                <label for="appointment_volume_${appointmentCount}">Thyroid Volume (cm³)</label>
                                <input type="number" id="appointment_volume_${appointmentCount}" class="appointment-volume" step="0.1" min="0" value="${appointment.volume}">
                            </div>
                        </div>
                    `;
                    
                    appointmentsContainer.insertAdjacentHTML('beforeend', appointmentHTML);
                });
                
                if (appointments.length > 0) {
                    showNotification(`Loaded ${appointments.length} appointment(s) for patient`, 'info');
                }
            }
            
            // Function to clear appointments
            function clearAppointments() {
                document.getElementById('appointmentsContainer').innerHTML = '';
            }
            
            // Function to show notifications
            function showNotification(message, type = 'info') {
                // Create notification element
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 15px 20px;
                    border-radius: 8px;
                    color: white;
                    font-weight: 600;
                    z-index: 1000;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                    animation: slideIn 0.3s ease;
                `;
                
                // Set color based on type
                if (type === 'success') {
                    notification.style.backgroundColor = '#2ecc71';
                } else if (type === 'error') {
                    notification.style.backgroundColor = '#e74c3c';
                } else {
                    notification.style.backgroundColor = '#3498db';
                }
                
                notification.textContent = message;
                
                // Add to document
                document.body.appendChild(notification);
                
                // Remove after 3 seconds
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => {
                        document.body.removeChild(notification);
                    }, 300);
                }, 3000);
                
                // Add CSS for animations
                if (!document.querySelector('#notification-styles')) {
                    const style = document.createElement('style');
                    style.id = 'notification-styles';
                    style.textContent = `
                        @keyframes slideIn {
                            from { transform: translateX(100%); opacity: 0; }
                            to { transform: translateX(0); opacity: 1; }
                        }
                        @keyframes slideOut {
                            from { transform: translateX(0); opacity: 1; }
                            to { transform: translateX(100%); opacity: 0; }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }
            
            // Initialize with first patient data
            loadPatientData('patient1');
            loadAppointments('patient1');
        });
    </script>
</body>
</html>
